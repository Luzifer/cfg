#!/bin/bash

function fail {
  echo "Error: $@"
  exit 1
}

[ -n "${TMUX}" ] && fail "You are already in tmux!"
( which tmux 2>/dev/null ) || fail "No tmux found, can't continue"

tmux-agent

if ! ( tmux list-sessions ); then
  tmux new-session -d
  tmux split-window -h
fi

tmux attach-session -t $(tmux list-sessions | sort -n | head -n1 | cut -d: -f1)
